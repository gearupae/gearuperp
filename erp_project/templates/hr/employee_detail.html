{% extends 'base.html' %}
{% block content %}
<div class="page-header">
    <nav aria-label="breadcrumb"><ol class="breadcrumb mb-2"><li class="breadcrumb-item"><a href="{% url 'hr:employee_list' %}">Employees</a></li><li class="breadcrumb-item active">{{ employee.employee_code }}</li></ol></nav>
    <div class="d-flex justify-content-between align-items-center">
        <div><h4 class="mb-1 fw-bold">{{ employee.full_name }}</h4><span class="text-muted">{{ employee.employee_code }}</span></div>
        <a href="{% url 'hr:employee_edit' employee.pk %}" class="btn btn-primary"><i class="fas fa-edit me-2"></i>Edit</a>
    </div>
</div>

<div class="row g-4">
    <div class="col-lg-8">
        <div class="card mb-4">
            <div class="card-header"><h6 class="mb-0 fw-semibold">Personal Information</h6></div>
            <div class="card-body">
                <div class="row g-4">
                    <div class="col-md-4"><h6 class="text-muted mb-2">Email</h6><p class="mb-0">{{ employee.email }}</p></div>
                    <div class="col-md-4"><h6 class="text-muted mb-2">Phone</h6><p class="mb-0">{{ employee.phone|default:"-" }}</p></div>
                    <div class="col-md-4"><h6 class="text-muted mb-2">Date of Birth</h6><p class="mb-0">{{ employee.date_of_birth|date:"d/m/Y"|default:"-" }}</p></div>
                    <div class="col-md-4"><h6 class="text-muted mb-2">Department</h6><p class="mb-0">{{ employee.department.name|default:"-" }}</p></div>
                    <div class="col-md-4"><h6 class="text-muted mb-2">Designation</h6><p class="mb-0">{{ employee.designation.name|default:"-" }}</p></div>
                    <div class="col-md-4"><h6 class="text-muted mb-2">Joining Date</h6><p class="mb-0">{{ employee.date_of_joining|date:"d/m/Y"|default:"-" }}</p></div>
                </div>
            </div>
        </div>
        <div class="card">
            <div class="card-header"><h6 class="mb-0 fw-semibold">Recent Leave Requests</h6></div>
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table mb-0">
                        <thead><tr><th>Type</th><th>From</th><th>To</th><th>Days</th><th>Status</th></tr></thead>
                        <tbody>
                            {% for leave in leave_requests %}
                            <tr>
                                <td>{{ leave.leave_type.name }}</td>
                                <td>{{ leave.start_date|date:"d/m/Y" }}</td>
                                <td>{{ leave.end_date|date:"d/m/Y" }}</td>
                                <td>{{ leave.days }}</td>
                                <td>{% if leave.status == 'approved' %}<span class="badge badge-active">Approved</span>{% elif leave.status == 'rejected' %}<span class="badge badge-inactive">Rejected</span>{% else %}<span class="badge bg-secondary">Pending</span>{% endif %}</td>
                            </tr>
                            {% empty %}<tr><td colspan="5" class="text-center py-4 text-muted">No leave requests</td></tr>{% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <div class="col-lg-4">
        <div class="card mb-4">
            <div class="card-body">
                <h6 class="text-muted mb-3">Status</h6>
                {% if employee.status == 'active' %}<span class="badge badge-active fs-6">Active</span>{% else %}<span class="badge badge-inactive fs-6">{{ employee.get_status_display }}</span>{% endif %}
            </div>
        </div>
        <div class="card mb-4">
            <div class="card-body">
                <h6 class="text-muted mb-3">Salary</h6>
                <h4 class="fw-bold mb-0">AED {{ employee.basic_salary|floatformat:2 }}</h4>
            </div>
        </div>
        <div class="card">
            <div class="card-body">
                <h6 class="text-muted mb-3">UAE Documents</h6>
                <div class="mb-2"><small class="text-muted">Emirates ID</small><p class="mb-0">{{ employee.emirates_id|default:"-" }}</p></div>
                <div class="mb-2"><small class="text-muted">Visa Number</small><p class="mb-0">{{ employee.visa_number|default:"-" }}</p></div>
                <div><small class="text-muted">Visa Expiry</small><p class="mb-0 {% if employee.visa_expiry %}{% now "Y-m-d" as today %}{% if employee.visa_expiry|date:"Y-m-d" < today %}text-danger{% endif %}{% endif %}">{{ employee.visa_expiry|date:"d/m/Y"|default:"-" }}</p></div>
            </div>
        </div>
    </div>
</div>
{% endblock %}



